public Map<String, Object> buildRequestPayload(ApiConfig config, Map<String, Object> runtimeData) {
    Map<String, Object> requestBody = new HashMap<>();
    RequestObjectConfig req = config.getRequestObject();

    if (req == null) return requestBody;

    if (req.isIncludeMapDefId() && runtimeData.containsKey("mapDefId")) {
        requestBody.put("mapDefId", runtimeData.get("mapDefId"));
    }

    if (req.isIncludeRequestId() && runtimeData.containsKey("requestId")) {
        requestBody.put("requestId", runtimeData.get("requestId"));
    }

    if (req.isIncludeMapData() && runtimeData.containsKey("mapData")) {
        requestBody.put("mapData", runtimeData.get("mapData"));
    }

    if (req.isIncludeConfigData() && runtimeData.containsKey("configData")) {
        requestBody.put("configData", runtimeData.get("configData"));
    }

    // Only add filePath if mapType is "file" and includeFilePath is true
    if ("file".equalsIgnoreCase(config.getMapType())
        && req.isIncludeFilePath()
        && runtimeData.containsKey("filePath")) {
        requestBody.put("filePath", runtimeData.get("filePath"));
    }

    return requestBody;
}
