import java.util.concurrent.*;

public class ServiceChecker {

    private static final ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);
    private static ScheduledFuture<?> scheduledFuture;

    public static void main(String[] args) {
        Runnable checkTask = new Runnable() {
            @Override
            public void run() {
                String response = checkService();

                System.out.println("Service response: " + response);

                if ("completed".equalsIgnoreCase(response)) {
                    System.out.println("Service is completed. Stopping scheduler.");
                    scheduledFuture.cancel(false);
                    scheduler.shutdown();
                }
            }
        };

        // Schedule task to run every 5 seconds
        scheduledFuture = scheduler.scheduleAtFixedRate(checkTask, 0, 5, TimeUnit.SECONDS);
    }

    // Simulated service check
    private static String checkService() {
        // Replace this with actual logic to call your service
        // Simulating a delayed completion
        if (Math.random() > 0.8) {
            return "completed";
        } else {
            return "in_progress";
        }
    }
}
