db.sourceCollection.aggregate([
  { $match: {} },  // optional filter, use {} to copy all
  {
    $merge: {
      into: "targetCollection",
      on: "_id",  // default, can be omitted if using _id
      whenMatched: "replace",        // overwrite if exists
      whenNotMatched: "insert"       // insert if not exists
    }
  }
]);
