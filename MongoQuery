{
    "$lookup": {
      "from": "collection2",
      "let": { "seq": "$delta.seq", "mapDefId": "$mapDefId" },
      "pipeline": [
        {
          "$match": {
            "$expr": {
              "$and": [
                { "$eq": ["$seq", "$$seq"] },
                { "$eq": ["$mapDefId", "$$mapDefId"] }
              ]
            }
          }
        }
      ],
      "as": "joined_docs"
    }
  },
